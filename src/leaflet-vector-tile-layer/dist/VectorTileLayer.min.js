import { DomUtil, extend, Layer, Path, point, Polygon, SVG, GridLayer, Util } from 'leaflet';var pointGeometry=Point;function Point(a,b){this.x=a;this.y=b}Point.prototype={clone:function(){return new Point(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,b){return this.clone()._rotateAround(a,b)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var b=a.x-this.x,c=a.y-this.y;return b*b+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,b){return Math.atan2(this.x*b-this.y*a,this.x*a+this.y*b)},_matMult:function(a){var b=a[0]*this.x+a[1]*this.y,c=a[2]*this.x+a[3]*this.y;this.x=b;this.y=c;return this},_add:function(a){this.x+=a.x;this.y+=a.y;return this},_sub:function(a){this.x-=a.x;this.y-=a.y;return this},_mult:function(a){this.x*=a;this.y*=a;return this},_div:function(a){this.x/=a;this.y/=a;return this},_multByPoint:function(a){this.x*=a.x;this.y*=a.y;return this},_divByPoint:function(a){this.x/=a.x;this.y/=a.y;return this},_unit:function(){this._div(this.mag());return this},_perp:function(){var a=this.y;this.y=this.x;this.x=-a;return this},_rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=b*this.x-c*this.y,e=c*this.x+b*this.y;this.x=d;this.y=e;return this},_rotateAround:function(a,b){var c=Math.cos(a),d=Math.sin(a),e=b.x+c*(this.x-b.x)-d*(this.y-b.y),f=b.y+d*(this.x-b.x)+c*(this.y-b.y);this.x=e;this.y=f;return this},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}};Point.convert=function(a){if(a instanceof Point){return a}if(Array.isArray(a)){return new Point(a[0],a[1])}return a};var vectortilefeature=VectorTileFeature;function VectorTileFeature(a,b,c,d,e){this.properties={};this.extent=c;this.type=0;this._pbf=a;this._geometry=-1;this._keys=d;this._values=e;a.readFields(readFeature,this,b)}function readFeature(a,b,c){a==1?(b.id=c.readVarint()):a==2?readTag(c,b):a==3?(b.type=c.readVarint()):a==4&&(b._geometry=c.pos)}function readTag(a,b){var c=a.readVarint()+a.pos;while(a.pos<c){var d=b._keys[a.readVarint()],e=b._values[a.readVarint()];b.properties[d]=e}}VectorTileFeature.types=['Unknown','Point','LineString','Polygon'];VectorTileFeature.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;var b=a.readVarint()+a.pos,c=1,d=0,e=0,f=0,g=[],h;while(a.pos<b){if(d<=0){var i=a.readVarint();c=i&0x7;d=i>>3}d--;if(c===1||c===2)e+=a.readSVarint(),f+=a.readSVarint(),c===1&&(h&&g.push(h),h=[]),h.push(new pointGeometry(e,f));else if(c===7)h&&h.push(h[0].clone());else{throw new Error('unknown command '+c)}}h&&g.push(h);return g};VectorTileFeature.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;var b=a.readVarint()+a.pos,c=1,d=0,e=0,f=0,g=Infinity,h=-Infinity,i=Infinity,j=-Infinity;while(a.pos<b){if(d<=0){var k=a.readVarint();c=k&0x7;d=k>>3}d--;if(c===1||c===2)e+=a.readSVarint(),f+=a.readSVarint(),e<g&&(g=e),e>h&&(h=e),f<i&&(i=f),f>j&&(j=f);else if(c!==7){throw new Error('unknown command '+c)}}return[g,i,h,j]};VectorTileFeature.prototype.toGeoJSON=function(a,b,c){var d=this.extent*Math.pow(2,c),e=this.extent*a,f=this.extent*b,g=this.loadGeometry(),h=VectorTileFeature.types[this.type],i,j;function k(a){for(var b=0;b<a.length;b++){var c=a[b],g=180-(c.y+f)*360/d;a[b]=[(c.x+e)*360/d-180,360/Math.PI*Math.atan(Math.exp(g*Math.PI/180))-90]}}switch(this.type){case 1:var l=[];for(i=0;i<g.length;i++)l[i]=g[i][0];g=l;k(g);break;case 2:for(i=0;i<g.length;i++)k(g[i]);break;case 3:g=classifyRings(g);for(i=0;i<g.length;i++){for(j=0;j<g[i].length;j++)k(g[i][j])};break};g.length===1?(g=g[0]):(h='Multi'+h);var m={type:"Feature",geometry:{type:h,coordinates:g},properties:this.properties};'id' in this&&(m.id=this.id);return m};function classifyRings(a){var b=a.length;if(b<=1)return[a];var c=[],d,e;for(var f=0;f<b;f++){var g=signedArea(a[f]);if(g===0)continue;e===undefined&&(e=g<0);e===g<0?(d&&c.push(d),d=[a[f]]):d.push(a[f])}d&&c.push(d);return c}function signedArea(a){var b=0;for(var c=0,d=a.length,e=d-1,f,g;c<d;e=c++)f=a[c],g=a[e],b+=(g.x-f.x)*(f.y+g.y);return b}var vectortilelayer=VectorTileLayer;function VectorTileLayer(a,b){this.version=1;this.name=null;this.extent=4096;this.length=0;this._pbf=a;this._keys=[];this._values=[];this._features=[];a.readFields(readLayer,this,b);this.length=this._features.length}function readLayer(a,b,c){a===15?(b.version=c.readVarint()):a===1?(b.name=c.readString()):a===5?(b.extent=c.readVarint()):a===2?b._features.push(c.pos):a===3?b._keys.push(c.readString()):a===4&&b._values.push(readValueMessage(c))}function readValueMessage(a){var b=null,c=a.readVarint()+a.pos;while(a.pos<c){var d=a.readVarint()>>3;b=d===1?a.readString():d===2?a.readFloat():d===3?a.readDouble():d===4?a.readVarint64():d===5?a.readVarint():d===6?a.readSVarint():d===7?a.readBoolean():null}return b}VectorTileLayer.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error('feature index out of bounds');this._pbf.pos=this._features[a];var b=this._pbf.readVarint()+this._pbf.pos;return new vectortilefeature(this._pbf,b,this.extent,this._keys,this._values)};var vectortile=VectorTile;function VectorTile(a,b){this.layers=a.readFields(readTile,{},b)}function readTile(a,b,c){if(a===3){var d=new vectortilelayer(c,c.readVarint()+c.pos);d.length&&(b[d.name]=d)}}var VectorTile$1=vectortile,VectorTileFeature$1=vectortilefeature;function featureLayer(a,b,c,d,e){let f=new Layer(e),g=SVG.create("path"),h=VectorTileFeature$1.types[a.type];e=extend({},e);f.feature=a;f.layerName=b;f.properties=a.properties;f.addTo=function b(a){f._map=a;f.addInteractiveTarget(g)};f.removeFrom=function a(){f.removeInteractiveTarget(g);delete f._map};f.setStyle=function b(a){let c=g;a=extend({},"Polygon"===h?Polygon.prototype.options:Path.prototype.options,a);a.stroke?(c.setAttribute("stroke",a.color),c.setAttribute("stroke-opacity",a.opacity),c.setAttribute("stroke-width",a.weight),c.setAttribute("stroke-linecap",a.lineCap),c.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?c.setAttribute("stroke-dasharray",a.dashArray):c.removeAttribute("stroke-dasharray"),a.dashOffset?c.setAttribute("stroke-dashoffset",a.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none");a.fill?(c.setAttribute("fill",a.fillColor||a.color),c.setAttribute("fill-opacity",a.fillOpacity),c.setAttribute("fill-rule",a.fillRule||"evenodd")):c.setAttribute("fill","none");a.interactive?(c.setAttribute("pointer-events","auto"),DomUtil.addClass(c,"leaflet-interactive")):(DomUtil.removeClass(c,"leaflet-interactive"),c.removeAttribute("pointer-events"));return c};switch(h){case "Point":break;case "LineString":;case "Polygon":g.setAttribute("d",SVG.pointsToPath(a.loadGeometry().map(a=>a.map(a=>point(a).scaleBy(d))),"Polygon"===h));e.className&&DomUtil.addClass(g,e.className);f.setStyle(e);c.appendChild(g);break};return f}var featureLayer$1=Object.freeze(featureLayer),featureTile=Object.freeze(function c(a,b){let d={},e=b.getTileSize(),f=SVG.create("svg"),g=SVG.create("g"),h=[];f.setAttribute("viewBox",`0 0 ${e.x} ${e.y}`);f.appendChild(g);function i(a,c,d){let e=b.getFeatureStyle(a,c);if(!e){return}let f=featureLayer$1(a,c,g,d,e);h.push(f);b.addFeatureLayer(f)}d.addVectorTile=function b(a){Object.keys(a.layers).forEach(function(b){let c=a.layers[b],d=e.divideBy(c.extent),f=0;while(f!==c.length)i(c.feature(f),b,d),f+=1});return d};d.eachFeatureLayer=a=>h.map(a);d.domElement=()=>f;d.coords=()=>a;return d});let fetch;"function"===typeof window.fetch?(fetch=window.fetch):(fetch=function(a){let b=new XMLHttpRequest();b.open("GET",a);b.responseType="arraybuffer";return new Promise(function(a){b.onload=()=>a({ok:200===b.status,status:b.status,statusText:b.statusText,arrayBuffer(){return b.response}});b.send()})});var fetch$1=Object.freeze(fetch),read=function(a,b,c,d,e){var f,g,h=e*8-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];l+=m;f=n&(1<<-k)-1;n>>=-k;k+=h;for(;k>0;f=f*256+a[b+l], l+=m, k-=8);g=f&(1<<-k)-1;f>>=-k;k+=d;for(;k>0;g=g*256+a[b+l], l+=m, k-=8);if(f===0)f=1-j;else if(f===i){return g?NaN:(n?-1:1)*Infinity}else g+=Math.pow(2,d),f-=j;return(n?-1:1)*g*Math.pow(2,f-d)},write=function(a,b,c,d,e,f){var g,h,i,j=f*8-e-1,k=(1<<j)-1,l=k>>1,m=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||b===0&&1/b<0?1:0;b=Math.abs(b);isNaN(b)||b===Infinity?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),g+l>=1?(b+=m/i):(b+=m*Math.pow(2,1-l)),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));for(;e>=8;a[c+n]=h&0xff, n+=o, h/=256, e-=8);g=g<<e|h;j+=e;for(;j>0;a[c+n]=g&0xff, n+=o, g/=256, j-=8);a[c+n-o]|=p*128},ieee754={read:read,write:write},pbf=Pbf;function Pbf(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0);this.pos=0;this.type=0;this.length=this.buf.length}Pbf.Varint=0;Pbf.Fixed64=1;Pbf.Bytes=2;Pbf.Fixed32=5;var SHIFT_LEFT_32=4294967296,SHIFT_RIGHT_32=1/SHIFT_LEFT_32;Pbf.prototype={destroy:function(){this.buf=null},readFields:function(a,b,c){c=c||this.length;while(this.pos<c){var d=this.readVarint(),e=d>>3,f=this.pos;this.type=d&0x7;a(e,b,this);this.pos===f&&this.skip(d)}return b},readMessage:function(a,b){return this.readFields(a,b,this.readVarint()+this.pos)},readFixed32:function(){var a=readUInt32(this.buf,this.pos);this.pos+=4;return a},readSFixed32:function(){var a=readInt32(this.buf,this.pos);this.pos+=4;return a},readFixed64:function(){var a=readUInt32(this.buf,this.pos)+readUInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;this.pos+=8;return a},readSFixed64:function(){var a=readUInt32(this.buf,this.pos)+readInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;this.pos+=8;return a},readFloat:function(){var a=ieee754.read(this.buf,this.pos,!0,23,4);this.pos+=4;return a},readDouble:function(){var a=ieee754.read(this.buf,this.pos,!0,52,8);this.pos+=8;return a},readVarint:function(a){var b=this.buf,c,d;d=b[this.pos++];c=d&0x7f;if(d<0x80)return c;d=b[this.pos++];c|=(d&0x7f)<<7;if(d<0x80)return c;d=b[this.pos++];c|=(d&0x7f)<<14;if(d<0x80)return c;d=b[this.pos++];c|=(d&0x7f)<<21;if(d<0x80)return c;d=b[this.pos];c|=(d&0x0f)<<28;return readVarintRemainder(c,a,this)},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2===1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,b=readUtf8(this.buf,this.pos,a);this.pos=a;return b},readBytes:function(){var a=this.readVarint()+this.pos,b=this.buf.subarray(this.pos,a);this.pos=a;return b},readPackedVarint:function(a,b){var c=readPackedEnd(this);a=a||[];while(this.pos<c)a.push(this.readVarint(b));return a},readPackedSVarint:function(a){var b=readPackedEnd(this);a=a||[];while(this.pos<b)a.push(this.readSVarint());return a},readPackedBoolean:function(a){var b=readPackedEnd(this);a=a||[];while(this.pos<b)a.push(this.readBoolean());return a},readPackedFloat:function(a){var b=readPackedEnd(this);a=a||[];while(this.pos<b)a.push(this.readFloat());return a},readPackedDouble:function(a){var b=readPackedEnd(this);a=a||[];while(this.pos<b)a.push(this.readDouble());return a},readPackedFixed32:function(a){var b=readPackedEnd(this);a=a||[];while(this.pos<b)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){var b=readPackedEnd(this);a=a||[];while(this.pos<b)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){var b=readPackedEnd(this);a=a||[];while(this.pos<b)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){var b=readPackedEnd(this);a=a||[];while(this.pos<b)a.push(this.readSFixed64());return a},skip:function(a){var b=a&0x7;if(b===Pbf.Varint)while(this.buf[this.pos++]>0x7f);else if(b===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(b===Pbf.Fixed32)this.pos+=4;else if(b===Pbf.Fixed64)this.pos+=8;else throw new Error('Unimplemented type: '+b)},writeTag:function(a,b){this.writeVarint(a<<3|b)},realloc:function(a){var b=this.length||16;while(b<this.pos+a)b*=2;if(b!==this.length){var c=new Uint8Array(b);c.set(this.buf);this.buf=c;this.length=b}},finish:function(){this.length=this.pos;this.pos=0;return this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4);writeInt32(this.buf,a,this.pos);this.pos+=4},writeSFixed32:function(a){this.realloc(4);writeInt32(this.buf,a,this.pos);this.pos+=4},writeFixed64:function(a){this.realloc(8);writeInt32(this.buf,a&-1,this.pos);writeInt32(this.buf,Math.floor(a*SHIFT_RIGHT_32),this.pos+4);this.pos+=8},writeSFixed64:function(a){this.realloc(8);writeInt32(this.buf,a&-1,this.pos);writeInt32(this.buf,Math.floor(a*SHIFT_RIGHT_32),this.pos+4);this.pos+=8},writeVarint:function(a){a=+a||0;if(a>0xfffffff||a<0){writeBigVarint(a,this);return}this.realloc(4);this.buf[this.pos++]=a&0x7f|(a>0x7f?0x80:0);if(a<=0x7f)return;this.buf[this.pos++]=(a>>>=7)&0x7f|(a>0x7f?0x80:0);if(a<=0x7f)return;this.buf[this.pos++]=(a>>>=7)&0x7f|(a>0x7f?0x80:0);if(a<=0x7f)return;this.buf[this.pos++]=a>>>7&0x7f},writeSVarint:function(a){this.writeVarint(a<0?-a*2-1:a*2)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a);this.realloc(a.length*4);this.pos++;var b=this.pos;this.pos=writeUtf8(this.buf,a,this.pos);var c=this.pos-b;c>=0x80&&makeRoomForExtraLength(b,c,this);this.pos=b-1;this.writeVarint(c);this.pos+=c},writeFloat:function(a){this.realloc(4);ieee754.write(this.buf,a,this.pos,!0,23,4);this.pos+=4},writeDouble:function(a){this.realloc(8);ieee754.write(this.buf,a,this.pos,!0,52,8);this.pos+=8},writeBytes:function(a){var b=a.length;this.writeVarint(b);this.realloc(b);for(var c=0;c<b;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,b){this.pos++;var c=this.pos;a(b,this);var d=this.pos-c;d>=0x80&&makeRoomForExtraLength(c,d,this);this.pos=c-1;this.writeVarint(d);this.pos+=d},writeMessage:function(a,b,c){this.writeTag(a,Pbf.Bytes);this.writeRawMessage(b,c)},writePackedVarint:function(a,b){this.writeMessage(a,writePackedVarint,b)},writePackedSVarint:function(a,b){this.writeMessage(a,writePackedSVarint,b)},writePackedBoolean:function(a,b){this.writeMessage(a,writePackedBoolean,b)},writePackedFloat:function(a,b){this.writeMessage(a,writePackedFloat,b)},writePackedDouble:function(a,b){this.writeMessage(a,writePackedDouble,b)},writePackedFixed32:function(a,b){this.writeMessage(a,writePackedFixed32,b)},writePackedSFixed32:function(a,b){this.writeMessage(a,writePackedSFixed32,b)},writePackedFixed64:function(a,b){this.writeMessage(a,writePackedFixed64,b)},writePackedSFixed64:function(a,b){this.writeMessage(a,writePackedSFixed64,b)},writeBytesField:function(a,b){this.writeTag(a,Pbf.Bytes);this.writeBytes(b)},writeFixed32Field:function(a,b){this.writeTag(a,Pbf.Fixed32);this.writeFixed32(b)},writeSFixed32Field:function(a,b){this.writeTag(a,Pbf.Fixed32);this.writeSFixed32(b)},writeFixed64Field:function(a,b){this.writeTag(a,Pbf.Fixed64);this.writeFixed64(b)},writeSFixed64Field:function(a,b){this.writeTag(a,Pbf.Fixed64);this.writeSFixed64(b)},writeVarintField:function(a,b){this.writeTag(a,Pbf.Varint);this.writeVarint(b)},writeSVarintField:function(a,b){this.writeTag(a,Pbf.Varint);this.writeSVarint(b)},writeStringField:function(a,b){this.writeTag(a,Pbf.Bytes);this.writeString(b)},writeFloatField:function(a,b){this.writeTag(a,Pbf.Fixed32);this.writeFloat(b)},writeDoubleField:function(a,b){this.writeTag(a,Pbf.Fixed64);this.writeDouble(b)},writeBooleanField:function(a,b){this.writeVarintField(a,Boolean(b))}};function readVarintRemainder(a,b,c){var d=c.buf,e,f;f=d[c.pos++];e=(f&0x70)>>4;if(f<0x80)return toNum(a,e,b);f=d[c.pos++];e|=(f&0x7f)<<3;if(f<0x80)return toNum(a,e,b);f=d[c.pos++];e|=(f&0x7f)<<10;if(f<0x80)return toNum(a,e,b);f=d[c.pos++];e|=(f&0x7f)<<17;if(f<0x80)return toNum(a,e,b);f=d[c.pos++];e|=(f&0x7f)<<24;if(f<0x80)return toNum(a,e,b);f=d[c.pos++];e|=(f&0x01)<<31;if(f<0x80)return toNum(a,e,b);throw new Error('Expected varint not more than 10 bytes')}function readPackedEnd(a){return a.type===Pbf.Bytes?a.readVarint()+a.pos:a.pos+1}function toNum(a,b,c){if(c){return b*0x100000000+(a>>>0)}return(b>>>0)*0x100000000+(a>>>0)}function writeBigVarint(a,b){var c,d;a>=0?(c=a%0x100000000|0,d=a/0x100000000|0):(c=~(-a%0x100000000),d=~(-a/0x100000000),c^0xffffffff?(c=c+1|0):(c=0,d=d+1|0));if(a>=0x10000000000000000||a<-18446744073709552000){throw new Error('Given varint doesn\'t fit into 10 bytes')}b.realloc(10);writeBigVarintLow(c,d,b);writeBigVarintHigh(d,b)}function writeBigVarintLow(a,b,c){c.buf[c.pos++]=a&0x7f|0x80;a>>>=7;c.buf[c.pos++]=a&0x7f|0x80;a>>>=7;c.buf[c.pos++]=a&0x7f|0x80;a>>>=7;c.buf[c.pos++]=a&0x7f|0x80;a>>>=7;c.buf[c.pos]=a&0x7f}function writeBigVarintHigh(a,b){var c=(a&0x07)<<4;b.buf[b.pos++]|=c|((a>>>=3)?0x80:0);if(!a)return;b.buf[b.pos++]=a&0x7f|((a>>>=7)?0x80:0);if(!a)return;b.buf[b.pos++]=a&0x7f|((a>>>=7)?0x80:0);if(!a)return;b.buf[b.pos++]=a&0x7f|((a>>>=7)?0x80:0);if(!a)return;b.buf[b.pos++]=a&0x7f|((a>>>=7)?0x80:0);if(!a)return;b.buf[b.pos++]=a&0x7f}function makeRoomForExtraLength(a,b,c){var d=b<=0x3fff?1:b<=0x1fffff?2:b<=0xfffffff?3:Math.ceil(Math.log(b)/(Math.LN2*7));c.realloc(d);for(var e=c.pos-1;e>=a;e--)c.buf[e+d]=c.buf[e]}function writePackedVarint(a,b){for(var c=0;c<a.length;c++)b.writeVarint(a[c])}function writePackedSVarint(a,b){for(var c=0;c<a.length;c++)b.writeSVarint(a[c])}function writePackedFloat(a,b){for(var c=0;c<a.length;c++)b.writeFloat(a[c])}function writePackedDouble(a,b){for(var c=0;c<a.length;c++)b.writeDouble(a[c])}function writePackedBoolean(a,b){for(var c=0;c<a.length;c++)b.writeBoolean(a[c])}function writePackedFixed32(a,b){for(var c=0;c<a.length;c++)b.writeFixed32(a[c])}function writePackedSFixed32(a,b){for(var c=0;c<a.length;c++)b.writeSFixed32(a[c])}function writePackedFixed64(a,b){for(var c=0;c<a.length;c++)b.writeFixed64(a[c])}function writePackedSFixed64(a,b){for(var c=0;c<a.length;c++)b.writeSFixed64(a[c])}function readUInt32(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+a[b+3]*0x1000000}function writeInt32(a,b,c){a[c]=b;a[c+1]=b>>>8;a[c+2]=b>>>16;a[c+3]=b>>>24}function readInt32(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+(a[b+3]<<24)}function readUtf8(a,b,c){var d='',e=b;while(e<c){var f=a[e],g=null,h=f>0xEF?4:f>0xDF?3:f>0xBF?2:1;if(e+h>c)break;var i,j,k;h===1?(f<0x80&&(g=f)):h===2?(i=a[e+1],(i&0xC0)===0x80&&(g=(f&0x1F)<<0x6|i&0x3F,g<=0x7F&&(g=null))):h===3?(i=a[e+1],j=a[e+2],(i&0xC0)===0x80&&(j&0xC0)===0x80&&(g=(f&0xF)<<0xC|(i&0x3F)<<0x6|j&0x3F,(g<=0x7FF||g>=0xD800&&g<=0xDFFF)&&(g=null))):h===4&&(i=a[e+1],j=a[e+2],k=a[e+3],(i&0xC0)===0x80&&(j&0xC0)===0x80&&(k&0xC0)===0x80&&(g=(f&0xF)<<0x12|(i&0x3F)<<0xC|(j&0x3F)<<0x6|k&0x3F,(g<=0xFFFF||g>=0x110000)&&(g=null)));g===null?(g=0xFFFD,h=1):g>0xFFFF&&(g-=0x10000,d+=String.fromCharCode(g>>>10&0x3FF|0xD800),g=0xDC00|g&0x3FF);d+=String.fromCharCode(g);e+=h}return d}function writeUtf8(a,b,c){for(var d=0,e,f;d<b.length;d++){e=b.charCodeAt(d);if(e>0xD7FF&&e<0xE000){if(f){if(e<0xDC00){a[c++]=0xEF;a[c++]=0xBF;a[c++]=0xBD;f=e;continue}else e=f-0xD800<<10|e-0xDC00|0x10000,f=null}else{e>0xDBFF||d+1===b.length?(a[c++]=0xEF,a[c++]=0xBF,a[c++]=0xBD):(f=e);continue}}else f&&(a[c++]=0xEF,a[c++]=0xBF,a[c++]=0xBD,f=null);e<0x80?(a[c++]=e):(e<0x800?(a[c++]=e>>0x6|0xC0):(e<0x10000?(a[c++]=e>>0xC|0xE0):(a[c++]=e>>0x12|0xF0,a[c++]=e>>0xC&0x3F|0x80),a[c++]=e>>0x6&0x3F|0x80),a[c++]=e&0x3F|0x80)}return c}function err(...a){return new Error(a.join(": "))}function load(a){return fetch$1(a).then(function(b){if(b.ok){return b.arrayBuffer()}if(404!==b.status){throw err(a,b.status,b.statusText)}})}function tileId(a){return`${a.x}|${a.y}|${a.z}`}let defaultOptions={minZoom:0,maxZoom:18,maxDetailZoom:undefined,minDetailZoom:undefined,subdomains:"abc",zoomOffset:0,zoomReverse:!1};var VectorTileLayer$2=Object.freeze(function c(a,b){let d=new GridLayer(b),e=Object.getPrototypeOf(d),f={};function g(a,c,d){let{getFeatureId:e,vectorTileLayerStyles:g}=b,h=g[c];if(e){let b=e(a);f[b]&&(h=f[b])}"function"===typeof h&&(h=h(a.properties,d));if(Array.isArray(h)){if(!h.length){return}h=h[0]}return h}b=Util.extend({},defaultOptions,b);"string"===typeof b.subdomains&&(b.subdomains=b.subdomains.split(""));b.vectorTileLayerStyles&&(b.style=g);let h={};d.on("tileunload",function(a){let b=tileId(a.coords),c=h[b];if(!c){return}c.eachFeatureLayer(a=>d.removeFeatureLayer(a));delete h[b]});let i,j;function k(){j=i.getZoom()}d.onAdd=function c(a,...b){i=a;i.on("zoomend",k);k();return e.onAdd.call(d,a,...b)};d.onRemove=function b(...a){i.off("zoomend",k);i=undefined;return e.onRemove.call(d,...a)};d.createTile=function c(a,b){let e=tileId(a),f=featureTile(a,d);h[e]=f;load(d.getTileUrl(a)).then(function(a){f.addVectorTile(new VectorTile$1(new pbf(a)));b(null,f)});return f.domElement()};function l(a){let c=Math.abs(a.x+a.y)%b.subdomains.length;return b.subdomains[c]}function m(a){let{minDetailZoom:c,maxDetailZoom:d}=b;if(undefined!==c&&a<c){return c}if(undefined!==d&&d<a){return d}return a}function n(a){let{maxZoom:c,zoomReverse:d,zoomOffset:e}=b;d&&(a=c-a);return m(a+e)}d.getTileUrl=function d(c){let e={s:l(c),x:c.x,y:c.y,z:n(c.z)};return Util.template(a,Util.extend(e,b))};function o(a){Object.keys(h).forEach(b=>h[b].eachFeatureLayer(a))}d.setStyle=function c(a){b.style=a;o(function(a){let{feature:b,layerName:c}=a,e=d.getFeatureStyle(b,c);a.setStyle(e)});return d};d.setFeatureStyle=function e(a,c){f[a]=c;d.setStyle(b.style);return d};d.resetFeatureStyle=function c(a){delete f[a];d.setStyle(b.style);return d};d.getTileSize=function a(){let b=e.getTileSize.call(d),c=d._tileZoom;return b.divideBy(i.getZoomScale(m(c),c)).round()};d.getFeatureStyle=function d(a,c){let e=b.style;return"function"===typeof e?e(a,c,j):e};d.addFeatureLayer=function b(a){a.addTo(i);a.addEventParent(d);return d};d.removeFeatureLayer=function b(a){a.removeEventParent(d);a.removeFrom(i);return d};return d});export default VectorTileLayer$2
//# sourceMappingURL=VectorTileLayer.min.js.map
